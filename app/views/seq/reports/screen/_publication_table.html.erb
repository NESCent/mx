<div class="header">Publication table</div>


<!-- header row 1 -->
<div style="border-bottom:1px dotted silver;padding:0.3em;clear:both;"><!-- row -->
  <div style="float:left;width:310;"><!-- taxal -->
    Taxa
  </div>
  <% @genes.each do |g| %>
    <div style="float:right;width:320;text-align:center;"><!-- gene col -->
      <%= g.name -%>
    </div><!-- end gene col -->
  <% end -%>
  <br style="clear:both;" /> 
</div>

<!-- header row 2 -->
<div style="border-bottom:1px dotted silver;padding:0.3em;clear:both;"><!-- row -->
  <div style="float:left;"><!-- taxal -->
    <div style="float:left;width:80;"><!-- family col -->
      Family
    </div>
    <div style="float:left;width:80;"><!-- subfamily col -->
      Subfamily 
    </div>
    <div style="float:left;width:120;"><!-- taxon col -->
      Taxon 
    </div>
    <div style="float:left;width:30;"><!-- taxon col -->
      OTU id 
    </div>
    <br style="clear:both;" />
  </div>
  <% @genes.each do |g| %>
    <div style="float:right;"><!-- gene col -->
      <div style="float:left;"><!-- otu row col -->
        <div style="border-bottom:1px dotted silver;"><!-- seq row  -->
          <div style="float:left;width:60;"><!-- genbank id -->
            Genbank ID
          </div>
          <div style="float:left;width:60;"><!-- seq id -->
            mx Seq ID
          </div>
          <div style="float:left;width:200;"><!-- specimen id -->
            Specimen ID
          </div>
        </div><!-- end seq row -->
        <br style="clear: both;" />
      </div><!-- end otu row -->
      <br style="clear: both;" />
    </div><!-- end gene col -->
  <% end -%>
  <br style="clear:both;" /> 
</div><!-- end otu col -->


<% @otus.each_with_index do |o,i| -%>
  <div style="border-bottom:1px dotted silver;padding:0.3em;clear:both;background-color:<%= (i % 2 == 0) ? '#eee' : 'white' -%>;"><!-- row -->

    <div style="float:left;"><!-- taxal -->

      <div style="float:left;width:80;"><!-- family col -->
        <%= o.taxon_name.andand.name_at_rank('family') -%>&nbsp;
      </div>
      <div style="float:left;width:80;"><!-- subfamily col -->
        <%= o.taxon_name.andand.name_at_rank('subfamily') -%>&nbsp;
      </div>
      <div style="float:left;width:120;"><!-- taxon col -->
        <%= o.taxon_name.andand.display_name -%>&nbsp;
      </div>
      <div style="float:left;width:30;"><!-- taxon col -->
        <%= link_to(o.id, :action => :show, :id => o.id, :controller => :otu) -%>&nbsp;
      </div>

      <br style="clear:both;" />
    </div>

    <% @genes.each_with_index do |g,j| %>
      <div style="float:right;background-color:<%= (j % 2 == 0) ? '#def' : 'white' -%>;"><!-- gene col -->

        <div style="float:left;"><!-- otu row col -->

          <% o.sequences(:gene_ids => [g.id]).each do |s| -%>
            <div style="border-bottom:1px dotted silver;"><!-- seq row  -->

              <div style="float:left;width:60;"><!-- genbank id -->
                <%= s.genbank_identifier.blank? ? 'X000000' : s.genbank_identifier -%>
              </div>
              <div style="float:left;width:60;"><!-- seq id -->
                <%= link_to(s.id, :action => 'show', :controller => 'seq', :id => s) -%>
              </div>
              <div style="float:left;width:200;"><!-- specimen id -->
                <%= s.source_specimen.andand.display_name(:type => :identifiers)  -%>
              </div>

            </div><!-- end seq row -->
          <% end -%>

          <br style="clear: both;" />
        </div><!-- end otu row -->

        <br style="clear: both;" />
      </div><!-- end gene col -->

    <% end -%>

    <br style="clear:both;" />
  </div><!-- end otu col -->
<% end -%>

